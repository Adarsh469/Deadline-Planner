(()=>{var e={};e.id=434,e.ids=[434],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},39491:e=>{"use strict";e.exports=require("assert")},14300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},63477:e=>{"use strict";e.exports=require("querystring")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},15206:e=>{"use strict";e.exports=require("zlib")},24904:()=>{},70258:(e,r,t)=>{"use strict";t.r(r),t.d(r,{originalPathname:()=>h,patchFetch:()=>x,requestAsyncStorage:()=>R,routeModule:()=>I,serverHooks:()=>g,staticGenerationAsyncStorage:()=>_});var s={};t.r(s),t.d(s,{GET:()=>E,POST:()=>v});var n=t(49303),i=t(88716),a=t(60670),o=t(83493),u=t(22114),d=t(75571),c=t(90455),l=t(31402),p=t(57435);async function E(e){try{let r=await (0,d.getServerSession)(c.L),t=r?.user?.id;if(!t)return(0,l.w)({error:"Unauthorized"},{status:401});let s=await o._.deadline.findMany({where:{userId:t},orderBy:"dueDate"===(e.nextUrl.searchParams.get("sort")||"urgency")?{dueDate:"asc"}:{urgencyScore:"desc"},include:{dependencies:!0,dependents:!0}});return(0,l.w)({data:s},{cacheControl:"private, max-age=30, stale-while-revalidate=60"})}catch(e){return(0,p.H)("deadlines.get.failed",{error:String(e)}),(0,l.w)({error:"Internal server error"},{status:500})}}async function v(e){try{let r=await (0,d.getServerSession)(c.L),t=r?.user?.id;if(!t)return(0,l.w)({error:"Unauthorized"},{status:401});let s=await e.json();if(!s?.title||!s?.dueDate||!s?.priority)return(0,l.w)({error:"Invalid payload"},{status:400});let n=new Date(s.dueDate);if(Number.isNaN(n.getTime()))return(0,l.w)({error:"Invalid dueDate"},{status:400});let i=(0,u.K)(s.priority,n),a=(0,u.R)(n);if(s.dependencyIds?.length){if(await o._.deadline.count({where:{id:{in:s.dependencyIds},userId:t}})!==s.dependencyIds.length)return(0,l.w)({error:"Invalid dependencies"},{status:403});await o._.deadline.count({where:{id:{in:s.dependencyIds},userId:t,status:{not:"COMPLETED"}}})>0&&(a="BLOCKED")}let p=await o._.deadline.create({data:{userId:t,title:s.title,description:s.description??null,dueDate:n,priority:s.priority,category:s.category??null,urgencyScore:i,status:a,recurrenceId:s.recurrenceId??null,dependencies:s.dependencyIds?.length?{createMany:{data:s.dependencyIds.map(e=>({blockerId:e}))}}:void 0}});return(0,l.w)({data:p},{status:201})}catch(e){return(0,p.H)("deadlines.post.failed",{error:String(e)}),(0,l.w)({error:"Internal server error"},{status:500})}}let I=new n.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/deadlines/route",pathname:"/api/deadlines",filename:"route",bundlePath:"app/api/deadlines/route"},resolvedPagePath:"/home/adarsh/Documents/New_folder/Deadline Planner/app/api/deadlines/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:R,staticGenerationAsyncStorage:_,serverHooks:g}=I,h="/api/deadlines/route";function x(){return(0,a.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:_})}},90455:(e,r,t)=>{"use strict";t.d(r,{L:()=>u});var s=t(14029),n=t(77234),i=t(13539),a=t(83493);let o=[];process.env.EMAIL_SERVER_HOST&&process.env.EMAIL_SERVER_PORT&&process.env.EMAIL_SERVER_USER&&process.env.EMAIL_SERVER_PASSWORD&&process.env.EMAIL_FROM&&o.push((0,s.Z)({server:{host:process.env.EMAIL_SERVER_HOST,port:Number(process.env.EMAIL_SERVER_PORT),auth:{user:process.env.EMAIL_SERVER_USER,pass:process.env.EMAIL_SERVER_PASSWORD}},from:process.env.EMAIL_FROM})),process.env.GOOGLE_CLIENT_ID&&process.env.GOOGLE_CLIENT_SECRET&&o.push((0,n.Z)({clientId:process.env.GOOGLE_CLIENT_ID,clientSecret:process.env.GOOGLE_CLIENT_SECRET}));let u={adapter:(0,i.N)(a._),providers:o,session:{strategy:"jwt"},callbacks:{jwt:async({token:e,user:r})=>(r&&(e.id=r.id),e),session:async({session:e,token:r})=>(e.user&&(e.user.id=r.id),e)}}},31402:(e,r,t)=>{"use strict";t.d(r,{w:()=>n});var s=t(87070);function n(e,r){let t={};return r?.cacheControl&&(t["Cache-Control"]=r.cacheControl),s.NextResponse.json(e,{status:r?.status??200,headers:t})}},57435:(e,r,t)=>{"use strict";t.d(r,{H:()=>s});let s=(e,r)=>(function(e,r,t){let s={level:e,message:r,...t?{meta:t}:{}};console[e](JSON.stringify(s))})("error",e,r)},83493:(e,r,t)=>{"use strict";t.d(r,{_:()=>n});let s=require("@prisma/client"),n=global.prisma??new s.PrismaClient({log:["error"]})},22114:(e,r,t)=>{"use strict";t.d(r,{K:()=>n,R:()=>i});let s={LOW:1,MEDIUM:2,HIGH:4,CRITICAL:8};function n(e,r){let t=Date.now(),n=Math.max(r.getTime()-t,1);return Number((s[e]/(n/36e5)).toFixed(4))}function i(e,r){return r?"COMPLETED":e.getTime()<Date.now()?"OVERDUE":"PENDING"}}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[948,972,65],()=>t(70258));module.exports=s})();